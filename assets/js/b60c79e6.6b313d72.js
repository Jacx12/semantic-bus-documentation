"use strict";(self.webpackChunksemantic_bus_documentation=self.webpackChunksemantic_bus_documentation||[]).push([[7847],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},l=Object.keys(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=o.createContext({}),u=function(e){var t=o.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=u(e.components);return o.createElement(i.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=u(n),m=r,g=c["".concat(i,".").concat(m)]||c[m]||d[m]||l;return n?o.createElement(g,a(a({ref:t},p),{},{components:n})):o.createElement(g,a({ref:t},p))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,a=new Array(l);a[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[c]="string"==typeof e?e:r,a[1]=s;for(var u=2;u<l;u++)a[u]=n[u];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5696:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>a,default:()=>d,frontMatter:()=>l,metadata:()=>s,toc:()=>u});var o=n(7462),r=(n(7294),n(3905));const l={},a=void 0,s={unversionedId:"utilisateur/bus-wiki/Composant:-Google-Sheets",id:"utilisateur/bus-wiki/Composant:-Google-Sheets",title:"Composant:-Google-Sheets",description:"utilisation de l'API V4",source:"@site/docs/utilisateur/bus-wiki/Composant:-Google-Sheets.md",sourceDirName:"utilisateur/bus-wiki",slug:"/utilisateur/bus-wiki/Composant:-Google-Sheets",permalink:"/semantic-bus-documentation/docs/utilisateur/bus-wiki/Composant:-Google-Sheets",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Composant:-Framacalc",permalink:"/semantic-bus-documentation/docs/utilisateur/bus-wiki/Composant:-Framacalc"},next:{title:"Composant:-Google-geocoding",permalink:"/semantic-bus-documentation/docs/utilisateur/bus-wiki/Composant:-Google-geocoding"}},i={},u=[{value:"utilisation de l&#39;API V4",id:"utilisation-de-lapi-v4",level:2},{value:"url",id:"url",level:3},{value:"Query Lanquage non support\xe9",id:"query-lanquage-non-support\xe9",level:3},{value:"exploitation des donn\xe9es",id:"exploitation-des-donn\xe9es",level:2},{value:"r\xe9cup\xe9ration de valeurs",id:"r\xe9cup\xe9ration-de-valeurs",level:3},{value:"mapping des champs",id:"mapping-des-champs",level:3},{value:"Ancienne documentation obsol\xe8te",id:"ancienne-documentation-obsol\xe8te",level:2},{value:"Exemple",id:"exemple",level:3},{value:"Param\xe8tres",id:"param\xe8tres",level:3}],p={toc:u},c="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(c,(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"- ATTENTION, Ce composant n'est plus support\xe9. La librairie sheetrock utilis\xe9e n'est plus compatible avec les derniere version de linux alpine utilis\xe9 par le Bus S\xe9mantique. Pour r\xe9cup\xe9rer des donn\xe9es d'un sheet google,  2 solutions sont possibles:\n- * passer par un interm\xe9diare comme nocodeAPI ou un instance n8n\n- * utliser l'API V4 de google avec une apikey. L'API V3 n'est plus disponible.\n")),(0,r.kt)("h2",{id:"utilisation-de-lapi-v4"},"utilisation de l'API V4"),(0,r.kt)("h3",{id:"url"},"url"),(0,r.kt)("p",null,"l'url \xe0 utiliser est de la forme\n",(0,r.kt)("inlineCode",{parentName:"p"},"https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}?key=${apiKey}")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"spreadsheetId : l'identifiant de votre spreadSheet que vous pouvez trouver dans l'url de celle-ci ",(0,r.kt)("inlineCode",{parentName:"li"},"https://docs.google.com/spreadsheets/d/spreadsheetId")),(0,r.kt)("li",{parentName:"ul"},"range : nom de la feuille"),(0,r.kt)("li",{parentName:"ul"},"apiKey : google impose desormais de disposer d'un apiKey pour identifier qui exploite l'API. ",(0,r.kt)("a",{parentName:"li",href:"https://cloud.google.com/docs/authentication/api-keys?hl=fr"},"cr\xe9er et utiliser une clef d'API"))),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/get?hl=fr"},"documentation google")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://developers.google.com/sheets/api/guides/migration?hl=fr#v4-api_9"},"documentation google expliquant la mgigration V3->V4")),(0,r.kt)("h3",{id:"query-lanquage-non-support\xe9"},"Query Lanquage non support\xe9"),(0,r.kt)("p",null,"les 'query' ne sont plus support\xe9 dans l'api V4\nextrait de la documentation : ",(0,r.kt)("inlineCode",{parentName:"p"},"L'API Sheets v4 n'a actuellement pas d'\xe9quivalent direct pour les requ\xeates structur\xe9es de l'API Sheets v3. Cependant, vous pouvez r\xe9cup\xe9rer les donn\xe9es pertinentes et les trier si n\xe9cessaire dans votre application."),"\nvous devrez mettre en place un filter pour pouvoir faire un equivalent."),(0,r.kt)("h2",{id:"exploitation-des-donn\xe9es"},"exploitation des donn\xe9es"),(0,r.kt)("h3",{id:"r\xe9cup\xe9ration-de-valeurs"},"r\xe9cup\xe9ration de valeurs"),(0,r.kt)("p",null,"composant 'root from path' param\xe9tr\xe9 en 'body.values'"),(0,r.kt)("h3",{id:"mapping-des-champs"},"mapping des champs"),(0,r.kt)("p",null,"si vous voulez retrouver les nom de colonne habituel, vous devez passer par un transformer avec cette logique"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "A": "$.0",\n  "B": "$.1",\n  "C": "$.2",\n  "D": "$.3",\n  "E": "$.4",\n  "F": "$.5",\n  "G": "$.6",\n  "H": "$.7",\n  "I": "$.8",\n...\n}\n')),(0,r.kt)("h2",{id:"ancienne-documentation-obsol\xe8te"},"Ancienne documentation obsol\xe8te"),(0,r.kt)("p",null,"Interroge une feuille de calcul Google Sheets qui fournit un flux JSON.\nLa requ\xeate utilise ce langage : ",(0,r.kt)("a",{parentName:"p",href:"https://developers.google.com/chart/interactive/docs/querylanguage"},"https://developers.google.com/chart/interactive/docs/querylanguage")," ."),(0,r.kt)("h3",{id:"exemple"},"Exemple"),(0,r.kt)("p",null,"Si votre url de Google Sheet est ",(0,r.kt)("a",{parentName:"p",href:"https://docs.google.com/spreadsheets/d/1snqE6leDkZlL61qQ4g-vUmiFjizJyN1OCVAhwWWKSm4/edit#gid=2024304766"},"https://docs.google.com/spreadsheets/d/1snqE6leDkZlL61qQ4g-vUmiFjizJyN1OCVAhwWWKSm4/edit#gid=2024304766")," et que vous souhaitez r\xe9cup\xe9rer les donn\xe9es de la colonne A et B en commen\xe7ant \xe0 la 5\xe8me ligne.\nIl faudra entrer ",(0,r.kt)("inlineCode",{parentName:"p"},"1snqE6leDkZlL61qQ4g-vUmiFjizJyN1OCVAhwWWKSm4/edit#gid=2024304766"),' en cl\xe9, "select A, B" dans "S\xe9lectionner les colonnes du Google Sheets" et "5" dans "Commencer \xe0 partir de la ligne :".'),(0,r.kt)("h3",{id:"param\xe8tres"},"Param\xe8tres"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Ins\xe9rer la cl\xe9 du Google Sheet"),": La cl\xe9 pr\xe9sente dans l'url du Google Sheets apr\xe8s ",(0,r.kt)("inlineCode",{parentName:"li"},"https://docs.google.com/spreadsheets/d")," jusqu'\xe0 la fin."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"S\xe9lectionner les colonnes du Google Sheets"),': Il faut y mettre le mot cl\xe9 "select" puis la ou les lettres des colonnes (s\xe9par\xe9es par des virgules si il y en a plusieurs). Si rien n\'est s\xe9lectionn\xe9, toutes les colonnes du Google Sheet sont r\xe9cup\xe9r\xe9es.'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Commencer \xe0 partir de la ligne (Offset)"),": Num\xe9ro de la ligne \xe0 partir de laquelle commencer le traitement des donn\xe9es. Il me semble que les lignes fig\xe9es sur les Google Sheets ne comptent pas dans le nombre des lignes comptabilis\xe9es.")))}d.isMDXComponent=!0}}]);